"use strict";function getRotate(){return(2-4*Math.random()).toFixed(2)}var app=angular.module("shriExam1App",["ngRoute","ngAnimate","ngSanitize","shriExam1App.service"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/main.html"}).when("/lectors",{templateUrl:"views/lectors.html",controller:"LectorsCtrl"}).when("/lectures",{templateUrl:"views/lectors.html",controller:"LectorsCtrl"}).when("/students",{templateUrl:"views/students.html",controller:"StudentsCtrl"}).otherwise({redirectTo:"/"}),b.hashPrefix("!")}]).run(["$location","$rootScope",function(a,b){b.isActive=function(b){return b===a.path()}}]).filter("firstLetterRed",function(){return function(a){return a.replace(/(.)/,'<span class="red-letter">$1</span>')}}),angular.module("shriExam1App.service",[]).factory("studentsService",["$http",function(a){return{dataFile:"data/students.json",getStudents:function(){return a.get(this.dataFile).error(function(){console.log("Cannot get students' data")}).then(function(a){var b=a.data;for(var c in b)b[c].rotation_degree=getRotate();return b})}}}]).factory("lectorsService",["$http",function(a){return{dataFile:"data/lectors_and_lectures.json",getLectors:function(){return a.get(this.dataFile).error(function(){console.log("Cannot get lectors' data")}).then(function(a){var b=a.data;for(var c in b)b[c].rotation_degree=getRotate();return b})}}}]),angular.module("shriExam1App").controller("StudentsCtrl",["$scope","studentsService",function(a,b){a.students=b.getStudents(),a.show_all_details=!1,a.sexChartData={},a.citiesChartData={},a.students.then(function(b){var c=[0,0],d=[];angular.forEach(b,function(a){"m"===a.sex?c[0]+=1:c[1]+=1,a.city in d?d[a.city]+=1:d[a.city]=1}),a.sexChartData=[{value:c[0],color:"#69D2E7",label:" лю ("+c[0]+")",labelColor:"white"},{value:c[1],color:"#F38630",label:" лќ ("+c[1]+")",labelColor:"white"}];var e=[],f=[];for(var g in d){var h=d[g];e.push(g),f.push(h)}a.citiesChartData={labels:e,datasets:[{fillColor:"rgba(151,187,205,0.5)",strokeColor:"rgba(151,187,205,1)",data:f}]}}),a.isStatisticsShown=!1,a.isChartDrown=!1,a.showStatistics=function(){if(a.isStatisticsShown)a.isStatisticsShown=!1;else if(a.isStatisticsShown=!0,!a.isChartDrown){a.isChartDrown=!0;var b=document.getElementById("students__statistics"),c=b.getContext("2d");new Chart(c).Pie(a.sexChartData,{});var b=document.getElementById("students__statistics_cities"),c=b.getContext("2d");new Chart(c).Bar(a.citiesChartData,{scaleFontColor:"#333",scaleFontSize:18,barValueSpacing:8})}}}]),angular.module("shriExam1App").controller("LectorsCtrl",["$scope","$location","lectorsService",function(a,b,c){a.path=b.path(),a.lectors=c.getLectors(),a.lectures=a.lectors.then(function(a){var b=[];return angular.forEach(a,function(a){angular.forEach(a.all_lectures,function(c){c.lector=a,b.push(c)})}),b})}]);